machine:
  environment:
    IMPORT_PATH: "${GOPATH%%:*}/src/github.com/${CIRCLE_PROJECT_USERNAME}/${CIRCLE_PROJECT_REPONAME}"

  services:
    - docker

dependencies:
  override:
    - sudo add-apt-repository -y ppa:masterminds/glide && sudo apt-get update; sudo apt-get install glide
    - mkdir -p "${IMPORT_PATH}"
    - mv "~/${CIRCLE_PROJECT_REPONAME}" "${IMPORT_PATH%/*}"
    - cd "${IMPORT_PATH}"

test:
  override:
    - make bootstrap test test-e2e
